From 37b5df86077954ff9575f78b485a7205858cc676 Mon Sep 17 00:00:00 2001
From: Zephyr Lykos <git@mochaa.ws>
Date: Mon, 8 Sep 2025 16:34:18 +0800
Subject: [PATCH 1/3] build: refactor CMake build rules

---
 CMakeLists.txt                        | 55 ++++++---------------------
 src/qt6ct-common/CMakeLists.txt       | 33 ++++++----------
 src/qt6ct-common/config.h.in          | 37 ++++++++++++++++++
 src/qt6ct-common/qt6ct.cpp            |  6 ++-
 src/qt6ct-common/qt6ct.h              |  4 ++
 src/qt6ct-qtplugin/CMakeLists.txt     |  8 ++--
 src/qt6ct-style/CMakeLists.txt        | 11 ++----
 src/qt6ct/CMakeLists.txt              | 12 +++---
 src/qt6ct/main.cpp                    |  5 +++
 src/qt6ct/translations/CMakeLists.txt | 48 +++++++++++++++++++++++
 10 files changed, 136 insertions(+), 83 deletions(-)
 create mode 100644 src/qt6ct-common/config.h.in
 create mode 100644 src/qt6ct/translations/CMakeLists.txt

diff --git a/src/qt6ct/CMakeLists.txt b/src/qt6ct/CMakeLists.txt
--- a/src/qt6ct/CMakeLists.txt
+++ b/src/qt6qt/CMakeLists.txt
@@ -1,5 +1,5 @@
 project(app)
-
+add_subdirectory(translations)
 set(app_SRCS
   appearancepage.cpp
   fontconfigdialog.cpp

diff --git a/src/qt6ct/translations/CMakeLists.txt b/src/qt6ct/translations/CMakeLists.txt
new file mode 100644
index 0000000..2777d3e
--- /dev/null
+++ b/src/qt6ct/translations/CMakeLists.txt
@@ -0,0 +1,50 @@
+set(translation_SRCS
+    qt6ct_ar.ts
+    qt6ct_bg.ts
+    qt6ct_ca.ts
+    qt6ct_cs.ts
+    qt6ct_da.ts
+    qt6ct_de.ts
+    qt6ct_el.ts
+    qt6ct_en.ts
+    qt6ct_es_ES.ts
+    qt6ct_es.ts
+    qt6ct_fi.ts
+    qt6ct_fr.ts
+    qt6ct_gl_ES.ts
+    qt6ct_he.ts
+    qt6ct_hu.ts
+    qt6ct_it_IT.ts
+    qt6ct_it.ts
+    qt6ct_ja.ts
+    qt6ct_kk.ts
+    qt6ct_lt.ts
+    qt6ct_nl_NL.ts
+    qt6ct_nl.ts
+    qt6ct_pl.ts
+    qt6ct_pt_BR.ts
+    qt6ct_pt.ts
+    qt6ct_ru.ts
+    qt6ct_sk.ts
+    qt6ct_sr_BA.ts
+    qt6ct_sr_RS.ts
+    qt6ct_sr.ts
+    qt6ct_tr.ts
+    qt6ct_uk.ts
+    qt6ct_zh_CN.ts
+    qt6ct_zh_TW.ts
+)
+
+set_source_files_properties(${translation_SRCS} PROPERTIES OUTPUT_LOCATION ".")
+qt6_add_translation(app_LANGS ${translation_SRCS})
+message("Hi got to here ${app_LANGS}")
+set_source_files_properties(${app_LANGS} PROPERTIES GENERATED TRUE)
+add_custom_target(app_translations DEPENDS ${app_LANGS})
+
+if(QT6CT_IN_TREE)
+  install(FILES ${app_LANGS} DESTINATION $ENV{DESTDIR}${CMAKE_INSTALL_DATADIR}/qt6/translations )
+else()
+  configure_file(translations.qrc translations.qrc COPYONLY)
+  qt6_add_resources(lang_RC ${CMAKE_CURRENT_BINARY_DIR}/translations.qrc)
+  add_library(app_resources INTERFACE ${lang_RC})
+endif()
-- 
2.51.0

